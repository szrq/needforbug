<!--<include file="header" />-->

<!--{script}-->
function findUser(){
	if(!$('#key').val()){
		needforbugAlert(D.L('用户关键字不能为空','AppJs'),'',3);
		return false;
	}else{
		return true;
	}
}

function changeDiv(buddyid){
	showDiv('commenthide_'+buddyid);
	showDiv('commentbox_'+buddyid);
	showDiv('commentedit_'+buddyid);
}

function editComment(buddyid){
	changeDiv(buddyid);
	document.getElementById('comment_'+buddyid).focus();
}

function updateComment(buddyid,fan){
	changeDiv(buddyid);
	var comment=Dyhb.Browser.Ie && document.charset=='utf-8'?encodeURIComponent(document.getElementById('comment_'+buddyid).value):document.getElementById('comment_'+ buddyid).value;
	document.getElementById('commenthide_'+buddyid).innerHTML=preg_replace(['&','<','>','"'],['&amp;','&lt;','&gt;','&quot;'], comment);
	Dyhb.AjaxSend('<!--{:Dyhb::U('home://friend/edit')}-->','ajax=1&friendid='+buddyid+'&comment='+comment+(fan=='1'?'&fan=1':''),'');
}

function preg_replace(search, replace, str){
	var len=search.length;
	for(var i=0;i < len;i++){
		re=new RegExp(search[i], "ig");
		str=str.replace(re,typeof replace=='string'?replace:(replace[i]?replace[i]:replace[0]));
	}
	
	return str;
}

function deleteFriend(friendid,fan){
	needforbugConfirm(D.L('确实要永久删除选择项吗？','__COMMON_LANG__@Admin/Common_Js'),function(){
		Dyhb.AjaxSend(D.U('home://friend/delete?friendid='+friendid+(fan=='1'?'&fan=1':'')),'','',function(data,status){
			if(status==1){
				window.location.reload();
			}
		});
	});
}
<!--{/script}-->

		<ul class="breadcrumb">
			<li><a href="<!--{:__APP__}-->">主页</a> <span class="divider">/</span></li>
			<li><!--{if $sType=='fan'}-->我的粉丝<!--{d*else}-->我的好友<!--{/if}--> <span class="divider">/</span></li>
			<li><a href="<!--{:Dyhb::U('home://stat/userlist')}-->">会员列表</a></li>
		</ul>
		
		<div class="row">
			<div class="span2">
				<div class="well" style="padding: 8px 0;">
					<ul class="nav nav-list">
						<li class="nav-header"><i class="icon-user"></i> 我的好友</li>
						<li class="active"><a href="#">好友列表</a></li>
						<li><a href="#">查找好友</a></li>
						<li><a href="#">可能认识的人</a></li>
						<li><a href="#">好友请求</a></li>
						<li><a href="#">好友分组</a></li>
						<li class="divider"></li>
						<li><a href="<!--{:Dyhb::U('home://user/index')}-->"><i class="icon-share-alt"></i> 返回个人中心</a></li>
					</ul>
				</div>
			</div>
		
			<div class="span10">
				<ul class="nav nav-pills">
					<li <!--{if !$sType=='fan'}-->class="active"<!--{/if}-->><a href="<!--{:Dyhb::U('home://friend/index')}-->">我的好友</a></li>
					<li <!--{if $sType=='fan'}-->class="active"<!--{/if}-->><a href="<!--{:Dyhb::U('home://friend/index?type=fan')}-->">我的粉丝</a></li>
				</ul>
				<form class="well form-search" action="<!--{:Dyhb::U('home://friend/index')}-->" method="get" onsubmit="return findUser();">
					<!--{if $sType=='fan'}--><input type="hidden" name="type" value="fan"><!--{/if}-->
					<input type="text" class="input-medium search-query" name="key" id="key">
					<button type="submit" class="btn"><i class="icon-search"></i> <!--{if $sType=='fan'}-->查找粉丝<!--{d*else}-->查找好友<!--{/if}--></button>
				</form>
				<!--{if $sKey}-->
				<div class="alert alert-info">
					你搜索的关键字为 <a href="<!--{:Dyhb::U('home://friend/index?key='.$sKey.($sType=='fan'?'&type=fan':''))}-->"><strong><span class="label label-success"><!--{$sKey}--></span></strong></a>，你可以查看 <a href="<!--{if $sType=='fan'}--><!--{:Dyhb::U('home://friend/index?type=fan')}--><!--{d*else}--><!--{:Dyhb::U('home://friend/index')}--><!--{/if}-->"><!--{if $sType=='fan'}-->粉丝列表<!--{d*else}-->好友列表<!--{/if}--></a>
				</div>
				<!--{/if}-->
				<!--{if is_array($arrFriends)}-->
				<ul class="thumbnails">
					<!--<foreach for=arrFriends value=oFriend>-->
					<!--{~$nUserId=($sType=='fan'?$oFriend['user_id']:$oFriend['friend_friendid'])}-->
					<li class="span3">
						<div class="thumbnail">
							<img src="<!--{:Core_Extend::avatar( $nUserId,'middle' )}-->" alt="">
							<div class="caption" style="text-align:center;">
								<a href="<!--{:Dyhb::U('home://my/user?id='.$nUserId)}-->"><h5><!--{:UserModel::getUsernameById($nUserId)}-->@<!--{$nUserId}--></h5></a>
								<p><!--{~$sUsersign=UserModel::getUsernameById($nUserId,'user_sign')}-->
									<!--{if $sUsersign}--><!--{$sUsersign|strip_tags}--><!--{d*else}-->该用户很懒，暂时没有签名<!--{/if}--><br/>
									<span id="commenthide_<!--{$nUserId}-->"><!--{if $sType=='fan'}--><!--{$oFriend['friend_fancomment']}--><!--{d*else)}--><!--{$oFriend['friend_comment']}--><!--{/if}--></span> <span id="commentedit_<!--{$nUserId}-->">[<a href="javascript:;" onclick="editComment(<!--{$nUserId}-->)">+添加备注</a>]</span>
									<span id="commentbox_<!--{$nUserId}-->" style="display:none"><input name="comment_<!--{$nUserId}-->" value="" id="comment_<!--{$nUserId}-->" onBlur="updateComment(<!--{$nUserId}-->,'<!--{if $sType=='fan'}-->1<!--{d*else}-->0<!--{/if}-->')" class="input-small"></span>
								</p>
								<p><a href="<!--{:Dyhb::U('home://pm/pmnew?uid='.$nUserId)}-->" class="btn btn-success"><i class="icon-envelope icon-white"></i> 短消息</a> <a href="javascript:void(0);" onclick="deleteFriend('<!--{$nUserId}-->','<!--{if $sType=='fan'}-->1<!--{d*else}-->0<!--{/if}-->');" class="btn"><i class="icon-remove-sign"></i> 删除</a></p>
							</div>
						</div>
					</li>
					<!--</foreach>-->
				</ul>
				<!--{d*else}-->
				<!--{if $sType=='fan'}-->暂时没有发现任何粉丝<!--{d*else}-->暂时没有发现任何好友<!--{/if}-->
				<!--{/if}-->
		
				<!--{$sPageNavbar}-->
			</div>
		</div><!--/row-->
		
<!--<include file="footer" />-->