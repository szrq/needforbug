<!--<include file="header" />-->

<!--{script}-->
function addShopaddress(){
	var sHtml = $.ajax({
		url: D.U('shop://shopcart/shopaddress'),
		async: false
	}).responseText;

	oEditNewshopaddress=needforbugAlert(sHtml,'配送地址','',addShopaddressok,'',500,100);
}

function addShopaddressok(){
	needforbugConfirm('你确定关闭配送地址管理器?',function(){
		oEditNewshopaddress.close();
		return true;
	},function(){
		return true;
	});
	return false;
}

function saveShopaddress(){
	$("#submit_button").attr("disabled", "disabled");
	$("#submit_button").val( 'add...' );

	Dyhb.AjaxSubmit('shopcartaddressForm','<!--{:Dyhb::U('shop://shopcart/save_consignee')}-->','',saveshopaddressComplete);
}

function saveshopaddressComplete(data,status){
	$("#submit_button").attr("disabled", false);
	$("#submit_button").val( '保存收件人地址' );

	if(status==1){
		oEditNewshopaddress.close();

		var sShopaddress='<td><span class="shopaddress-tip">寄送至</span></td>'+
						'<td><input name="shopaddress_id" value="'+data.shopaddress_id+'" checked="checked" type="radio"></td>'+
						'<td><label>'+data.shopaddressto+data.shopaddress_address+' ('+data.shopaddress_consignee+' 收)&nbsp;<em>'+data.shopaddress_mobile+'</em></label><td>'+
						'<td><em class="shopaddress-default" style="display:none;">默认地址</em></td>'+
						'<td><a href="" style="display:none;">设置为默认收货地址</a></td>';
		
		if($('#shopaddressid_'+data.shopaddress_id).length>0){
			$('#shopaddressid_'+data.shopaddress_id).html(sShopaddress);
		}else{
			sShopaddress=
				'<tr class="shopaddress-selected" id="shopaddressid_'+data.shopaddress_id+'">'+
					sShopaddress+
				'</tr>';

			$('#shopaddress-list').prepend(sShopaddress);
		}

		if($('#shopaddress-none').length>0){
			$('#shopaddress-none').remove();
		}
	}
}

function showShoppaymentdescription(id){
	$('#'+id).toggle('fast');
}
<!--{/script}-->

<!--{style}-->
.shopaddress-table{
	width: 100%;
}

.shopaddress-table th,
.shopaddress-table td {
  padding: 8px;
  line-height: 18px;
  text-align: left;
  vertical-align: top;
}

.shopaddress-table td {
	padding:10px 5px 5px 5px;
}

.shopaddress-tip{
	background: url("<!--{:__TMPLPUB__DEFAULT__}-->/Images/shopaddress_tip.gif") no-repeat scroll 0 0 transparent;
	padding: 4px 0 0px 20px;
	width: 15px;
	color: #FF5500;
	font-weight:bold;
}
.shopaddress-selected{
    background-color: #FFF5CC;
    border: 1px solid #FFE580;
}
<!--{/style}-->
	
	<div class="span12" style="text-align:left;margin-top:20px;">
		<ul class="breadcrumb">
			<li><a href="<!--{:Dyhb::U('shop://public/index')}-->" title="<!--<lang package='__COMMON_LANG__@Template/Common'>-->主页<!--</lang>-->"><i class='icon-home'></i></a>&nbsp;<span class="divider">/</span>&nbsp;</li>
			<li class="active">提交订单</li>
		</ul>
	</div>

	<!--<include file="shopcart+menu" />-->

	<!--{if $nNotlogin==1}-->
	<div class="span12" style="margin-top:20px;">
		<p class="alert">亲爱的用户，你已经启用【不登录直接购买】模式<span class="pipe">|</span><a href="<!--{:Dyhb::U('shop://shopcart/clearnotlogin')}-->">清除状态</a></p>
	</div>
	<!--{/if}-->

	<form action="<!--{:Dyhb::U('shop://shopcart/done')}-->" method="post" name="shoporderinfoForm" id="shoporderinfoForm">
		<div class="span12" style="margin-top:20px;">
			<h3>收货人联系方式</h3>
			<hr/>
			<p>
				<table class="shopaddress-table" border="0">
					<thead>
						<tr>
							<th width="60">选择</th>
							<th width="30"></th>
							<th colspan="4">寄送信息</th>
						</tr>
					</thead>
					<tbody id="shopaddress-list">
						<!--{if !empty($arrShopaddressDatas)}-->
						<!--<foreach for=arrShopaddressDatas value=arrShopaddress>-->
						<tr class="<!--{if !empty($arrShopaddress['selected'])}-->shopaddress-selected<!--{/if}-->" id="shopaddressid_<!--{$arrShopaddress['shopaddress_id']}-->">
							<td><span class="shopaddress-tip">寄送至</span></td>
							<td><input name="shopaddress_id" value="<!--{$arrShopaddress['shopaddress_id']}-->" <!--{if !empty($arrShopaddress['selected'])}-->checked="checked"<!--{/if}--> type="radio"></td>
							<td><label><!--{$arrShopaddress['shopaddressto']}--> (<!--{$arrShopaddress['shopaddress_consignee']}--> 收)&nbsp;<em><!--{$arrShopaddress['shopaddress_mobile']}--></em></label>
							<td>
							<td><em class="shopaddress-default" style="<!--{if $arrShopaddress['default']!='1'}-->display: none;<!--{/if}-->">默认地址</em></td>
							<td><a href="" style="display: none;">设置为默认收货地址</a></td>
						</tr>
						<!--</foreach>-->
						<!--{d*else}-->
						<tr id="shopaddress-none">
							<td colspan="6">暂时没有任何配送地址，请点击下面的按钮新增一个</td>
						</tr>
						<!--{/if}-->
					</tbody>
				</table>
			</p>
			<div class="row" style="margin-top:20px;">
				<div class="span3">&nbsp</div>
				<div class="span9">
					<a href="javascript:void(0);" onclick="addShopaddress();" class="btn"><i class="icon-plus"></i>&nbsp;新增配送地址</a>
				</div>
			</div>
		</div>

		<div class="span12" style="margin-top:30px;">
			<h3>购物车商品列表</h3>
			<p>
				<table class="table">
					<thead>
						<tr>
							<th width="65">作品</th>
							<td></th>
							<th>购买件数</th>
							<th>购买价格</th>
						</tr>
					</thead>
					<tbody>
						<!--<foreach for=arrShopcartsData value=arrShopcart>-->
						<tr>
							<td>
								<img src="<!--{$arrShopcart['goods_img']}-->" alt="" width="60" height="60" class="thumbnail">
							</td>
							<td><a href="<!--{:Dyhb::U('shop://goods@?id='.$arrShopcart['goods_id'])}-->" target="_blank"><!--{$arrShopcart['goods_name']}--></a></td>
							<td><input type="text" name="shopcartcount[<!--{$arrShopcart['goods_id']}-->]" value="<!--{$arrShopcart['goods_count']}-->" style="width:50px;"></td>
							<td><!--{$arrShopcart['goods_price']}--></td>
						</tr>
						<!--</foreach>-->
					</tbody>
				</table>
			</p>
			<div class="row">
				<div class="span12">
					购物车中商品数量为 <span style="color:red;font-size:15px;font-weight:bold;line-height:15px;"><!--{$arrShopcartsTotal['goods_count']}--></span>，购物金额小计 <span style="color:red;font-size:25px;font-weight:bold;line-height:25px;">￥<!--{$arrShopcartsTotal['goods_price']}--></span>
				</div>
			</div>
		</div>

		<div class="span12" style="margin-top:30px;">
			<h3>支付方式</h3>
			<hr/>
			<!--{if $arrShoppayments}-->
			<p>
				<ul class="thumbnails">
					<!--<foreach for=arrShoppayments value=oShoppayment>-->
					<li class="span6">
						<div class="thumbnail" style="padding:15px 10px;">
							<h4><input name="shoppayment_id" value="<!--{$oShoppayment['shoppayment_id']}-->" type="radio" <!--{if 
							$oShoppayment['shoppayment_id']==$nShopshippingid}-->checked="checked"<!--{/if}-->>&nbsp;&nbsp;<!--{$oShoppayment['shoppayment_name']}-->&nbsp;<i class="icon-eye-open" href="javascript:void(0);" onclick="showShoppaymentdescription('shoppaymentdescription_<!--{$oShoppayment['shoppayment_id']}-->');"></i></h4>
							<p id="shoppaymentdescription_<!--{$oShoppayment['shoppayment_id']}-->" style="margin:10px 0px 5px 0px;background:#eeeeee;-webkit-border-radius: 6px;-moz-border-radius: 6px;border-radius: 6px;padding:20px 10px;display:none;"><!--{$oShoppayment['shoppayment_description']}--></p>
							<p style="margin-top:10px;">手续费&nbsp;(<span style="color:red;font-size:13px;font-weight:bold;line-height:13px;">￥<!--{$oShoppayment['shoppayment_fee']}--></span>)</p>
						</div>
					</li>
					<!--</foreach>-->
				</ul>
			</p>
			<!--{d*else}-->
			<p>网站还没有提供任何支付方式，请联系客户人员咨询</p>
			<!--{/if}-->
		</div>

		<div class="span12" style="margin-top:30px;">
			<h3>配送方式</h3>
			<hr/>
			<!--{if $arrShopshippings}-->
			<p>
				<div class="row">
					<!--<foreach for=arrShopshippings value=oShopshipping>-->
					<!--{~$nShopshippingItemfee=!empty($arrShippingData['shopshipping_configure'][0]['value'])?$arrShippingData['shopshipping_configure'][0]['value']:0}-->
					<div class="span6">
						<h4><input name="shopshipping_id" value="<!--{$oShopshipping['shopshipping_id']}-->" type="radio">&nbsp;&nbsp;<!--{$oShopshipping['shopshipping_name']}--></h4>
						<p style="margin:10px 0px 5px 0px;background:#eeeeee;-webkit-border-radius: 6px;-moz-border-radius: 6px;border-radius: 6px;padding:20px 10px;"><!--{$oShopshipping['shopshipping_description']|G+subString=0,30}-->...</p>
						<p id="shopshippingdescription_<!--{$oShopshipping['shopshipping_id']}-->" style="margin:10px 0px 5px 0px;background:#eeeeee;-webkit-border-radius: 6px;-moz-border-radius: 6px;border-radius: 6px;padding:20px 10px;display:none;"><!--{$oShopshipping['shopshipping_description']}--></p>
						<p style="margin-top:10px;">费用&nbsp;<span style="color:red;font-size:13px;font-weight:bold;line-height:13px;">￥<!--{$nShopshippingItemfee}--></span>
							<span class="pipe">|</span>
							免费额度&nbsp;<span style="color:red;font-size:13px;font-weight:bold;line-height:13px;">￥0.00</span>
							<span class="pipe">|</span>
							保价费用&nbsp;<span style="color:red;font-size:13px;font-weight:bold;line-height:13px;"><!--{if $oShopshipping['shopshipping_insure']>0}--><!--{$oShopshipping['shopshipping_insure']}--><!--{d*else}-->不支持保价<!--{/if}--></span>
						</p>
					</div>
					<div class="span6">
						<h4><input name="shopshipping_id" value="<!--{$oShopshipping['shopshipping_id']}-->" type="radio">&nbsp;&nbsp;<!--{$oShopshipping['shopshipping_name']}--></h4>
						<p id="shopshippingdescription_<!--{$oShopshipping['shopshipping_id']}-->" style="margin:10px 0px 5px 0px;background:#eeeeee;-webkit-border-radius: 6px;-moz-border-radius: 6px;border-radius: 6px;padding:20px 10px;display:none;"><!--{$oShopshipping['shopshipping_description']}--></p>
						<p><a class="btn" href="#">View details &raquo;</a></p>
					</div>
					<!--</foreach>-->
				</div>
				
				<table class="table" id="shippingTable">
					<thead>
						<tr>
							<th width="5%">名称</th>
							<th width="75%"></th>
							<th width="20%">配送费用</th>
						</tr>
					</thead>
					<tbody>
						<!--<foreach for=arrShopshippings value=oShopshipping>-->
						<!--{~$nShopshippingItemfee=!empty($arrShippingData['shopshipping_configure'][0]['value'])?$arrShippingData['shopshipping_configure'][0]['value']:0}-->
						<tr>
							<td valign="top">
								<input name="shopshipping_id" value="<!--{$oShopshipping['shopshipping_id']}-->" type="radio">
							</td>
							<td valign="top"><strong><!--{$oShopshipping['shopshipping_name']}--></strong>&nbsp;<i class="icon-eye-open" href="javascript:void(0);" onclick="showShoppaymentdescription('shopshippingdescription_<!--{$oShopshipping['shopshipping_id']}-->');"></i>
								<br/>
								<p id="shopshippingdescription_<!--{$oShopshipping['shopshipping_id']}-->" style="margin:10px 0px 5px 0px;background:#eeeeee;-webkit-border-radius: 6px;-moz-border-radius: 6px;border-radius: 6px;padding:20px 10px;display:none;"><!--{$oShopshipping['shopshipping_description']}--></p>
							</td>
							<td align="right" valign="top">
								费用&nbsp;<span style="color:red;font-size:15px;font-weight:bold;line-height:15px;">￥<!--{$nShopshippingItemfee}--></span><br/>
								免费额度&nbsp;<span style="color:red;font-size:15px;font-weight:bold;line-height:15px;">￥0.00</span><br/>
								保价费用&nbsp;<span style="color:red;font-size:15px;font-weight:bold;line-height:15px;"><!--{if $oShopshipping['shopshipping_insure']>0}--><!--{$oShopshipping['shopshipping_insure']}--><!--{d*else}-->不支持保价<!--{/if}--></span>
							</td>
						</tr>
						<!--</foreach>-->
						<tr>
							<td colspan="6" align="right" style="text-align:right;">
								<input name="need_insure" value="1" disabled="true" type="checkbox">&nbsp;配送是否需要保价
							</td>
						</tr>
					</tbody>
				</table>
			</p>
			<!--{d*else}-->
			<p>网站还没有提供任何配送方式，请联系客户人员咨询</p>
			<!--{/if}-->
		</div>

		<div class="span12" style="margin-top:10px;">
			<h3>商品包装</h3>
			<table id="packTable" align="center" bgcolor="#dddddd" border="0" cellpadding="5" cellspacing="1" width="99%">
				<tbody>
					<tr>
						<th scope="col" bgcolor="#ffffff" width="5%">&nbsp;</th>
						<th scope="col" bgcolor="#ffffff" width="35%">名称</th>
						<th scope="col" bgcolor="#ffffff" width="22%">价格</th>
						<th scope="col" bgcolor="#ffffff" width="22%">免费额度</th>
						<th scope="col" bgcolor="#ffffff">图片</th>
					</tr>
					<tr>
						<td bgcolor="#ffffff" valign="top"><input name="pack" value="0" checked="true" onclick="selectPack(this)" type="radio"></td>
						<td bgcolor="#ffffff" valign="top"><strong>不要包装</strong></td>
						<td bgcolor="#ffffff" valign="top">&nbsp;</td>
						<td bgcolor="#ffffff" valign="top">&nbsp;</td>
						<td bgcolor="#ffffff" valign="top">&nbsp;</td>
					</tr>
					<tr>
						<td bgcolor="#ffffff" valign="top"><input name="pack" value="1" onclick="selectPack(this)" type="radio">
						</td>
						<td bgcolor="#ffffff" valign="top"><strong>精品包装</strong></td>
						<td align="right" bgcolor="#ffffff" valign="top">￥5.00元</td>
						<td align="right" bgcolor="#ffffff" valign="top">￥800.00元</td>
						<td align="center" bgcolor="#ffffff" valign="top">
							<a href="xxxx" target="_blank" class="f6">查看</a>
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="span12" style="margin-top:10px;">
			<h3>其它信息</h3>
			<table  class="table" align="center" bgcolor="#dddddd" border="0" cellpadding="5" cellspacing="1" width="99%">
				<tbody>
					<tr>
						<td bgcolor="#ffffff" valign="top"><strong>订单附言:</strong></td>
						<td bgcolor="#ffffff"><textarea name="shoporderinfo_postscript" cols="80" rows="3" id="shoporderinfo_postscript" style="border:1px solid #ccc;"></textarea></td>
					</tr>
					<tr>
						<td bgcolor="#ffffff"><strong>缺货处理:</strong></td>
						<td bgcolor="#ffffff">
							<input name="shoporderinfo_howoos" value="0" checked="checked" onclick="" type="radio">等待所有商品备齐后再发&nbsp;&nbsp;
							<input name="shoporderinfo_howoos" value="1" onclick="" type="radio">取消订单&nbsp;&nbsp;
							<input name="shoporderinfo_howoos" value="2" onclick="" type="radio">与店主协商
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="span12" style="margin-top:10px;">
			<h3>费用总计</h3>
			<table class="table" align="center" bgcolor="#dddddd" border="0" cellpadding="5" cellspacing="1" width="99%">
				<tbody>
					<tr>
						<td align="right" bgcolor="#ffffff">商品总价: <font>￥<!--{$arrShopcartsTotal['goods_price']}-->元</font></td>
					</tr>
					<tr>
						<td align="right" bgcolor="#ffffff"> 应付款金额: <font>￥<!--{$arrShopcartsTotal['goods_price']}-->元</font></td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="span12" style="margin-top:10px;text-align:center;">
			<input type="hidden" name="needpay" value="<!--{$arrShopcartsTotal['goods_price']}-->">
			<input type="submit" value="提交订单" class="btn btn-large btn-success">
		</div>
	</form>

<!--<include file="footer" />-->
